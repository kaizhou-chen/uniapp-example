import{d as a,g as e,l,m as t,o as s,c as u,w as o,i as n,a as c,b as r,n as d,u as i,t as f,T as v,x as m,G as p,j as _,h,e as b,R as k,U as y,V as g,W as C,X as x,q as V}from"./index-DCPBTn-6.js";import{h as L}from"./http.DPrrEsRc.js";import{u as T,_ as j}from"./plugin-vueexport-helper.DcVDw98L.js";const w=j(a({__name:"profile",setup(a){const{safeAreaInsets:j}=e(),w=l({}),U=async()=>{const a=await L({method:"GET",url:"/member/profile"});w.value=a.result},F=T();t((()=>{U()}));const P=()=>{uni.chooseMedia({count:1,mediaType:["image"],success:a=>{const{tempFilePath:e}=a.tempFiles[0];v({url:"/member/profile/avatar",name:"file",filePath:e,success:a=>{if(200===a.statusCode){const e=JSON.parse(a.data);w.value.avatar=e.avatar,m({icon:"success",title:"更新成功"})}else m({icon:"error",title:"更新失败"})}})}})},G=a=>{w.value.gender=a.detail.value},I=a=>{w.value.birthday=a.detail.value};let q=["","",""];const A=a=>{w.value.fullLocation=a.detail.value.join(" "),q=a.detail.code},B=async()=>{const{nickname:a,gender:e,birthday:l,fullLocation:t,profession:s}=w.value,[u,o,n]=q;var c;await(c={nickname:a,gender:e,birthday:l,fullLocation:t,provinceCode:u,cityCode:o,countyCode:n,profession:s},L({method:"PUT",url:"/member/profile",data:c})),F.profile.nickname=w.value.nickname,m({icon:"success",title:"更新成功"}),setTimeout((()=>{p()}),500)};return(a,e)=>{const l=_,t=n,v=h,m=b,p=k,L=y,T=g,U=C,F=x,q=V;return s(),u(t,{class:"viewport"},{default:o((()=>{var a;return[c(t,{class:"navbar",style:d({paddingTop:(null==(a=i(j))?void 0:a.top)+"px"})},{default:o((()=>[c(l,{"open-type":"navigateBack",class:"back icon-left","hover-class":"none"}),c(t,{class:"title"},{default:o((()=>[r("个人信息")])),_:1})])),_:1},8,["style"]),c(t,{class:"avatar"},{default:o((()=>[c(t,{onClick:P,class:"avatar-content"},{default:o((()=>{var a;return[c(v,{class:"image",src:null==(a=w.value)?void 0:a.avatar,mode:"aspectFill"},null,8,["src"]),c(m,{class:"text"},{default:o((()=>[r("点击修改头像")])),_:1})]})),_:1})])),_:1}),c(t,{class:"form"},{default:o((()=>[c(t,{class:"form-content"},{default:o((()=>[c(t,{class:"form-item"},{default:o((()=>[c(m,{class:"label"},{default:o((()=>[r("账号")])),_:1}),c(m,{class:"account"},{default:o((()=>{var a;return[r(f(null==(a=w.value)?void 0:a.account),1)]})),_:1})])),_:1}),c(t,{class:"form-item"},{default:o((()=>[c(m,{class:"label"},{default:o((()=>[r("昵称")])),_:1}),c(p,{class:"input",type:"text",placeholder:"请填写昵称",modelValue:w.value.nickname,"onUpdate:modelValue":e[0]||(e[0]=a=>w.value.nickname=a)},null,8,["modelValue"])])),_:1}),c(t,{class:"form-item"},{default:o((()=>[c(m,{class:"label"},{default:o((()=>[r("性别")])),_:1}),c(U,{onChange:G},{default:o((()=>[c(T,{class:"radio"},{default:o((()=>{var a;return[c(L,{value:"男",color:"#27ba9b",checked:"男"===(null==(a=w.value)?void 0:a.gender)},null,8,["checked"]),r(" 男 ")]})),_:1}),c(T,{class:"radio"},{default:o((()=>{var a;return[c(L,{value:"女",color:"#27ba9b",checked:"女"===(null==(a=w.value)?void 0:a.gender)},null,8,["checked"]),r(" 女 ")]})),_:1})])),_:1})])),_:1}),c(t,{class:"form-item"},{default:o((()=>{var a;return[c(m,{class:"label"},{default:o((()=>[r("生日")])),_:1}),c(F,{class:"picker",mode:"date",start:"1900-01-01",end:new Date,value:null==(a=w.value)?void 0:a.birthday,onChange:I},{default:o((()=>{var a;return[(null==(a=w.value)?void 0:a.birthday)?(s(),u(t,{key:0},{default:o((()=>[r(f(w.value.birthday),1)])),_:1})):(s(),u(t,{key:1,class:"placeholder"},{default:o((()=>[r("请选择日期")])),_:1}))]})),_:1},8,["end","value"])]})),_:1}),c(t,{class:"form-item"},{default:o((()=>{var a,e;return[c(m,{class:"label"},{default:o((()=>[r("城市")])),_:1}),c(F,{class:"picker",mode:"region",value:null==(e=null==(a=w.value)?void 0:a.fullLocation)?void 0:e.split(" "),onChange:A},{default:o((()=>{var a;return[(null==(a=w.value)?void 0:a.fullLocation)?(s(),u(t,{key:0},{default:o((()=>[r(f(w.value.fullLocation),1)])),_:1})):(s(),u(t,{key:1,class:"placeholder"},{default:o((()=>[r("请选择城市")])),_:1}))]})),_:1},8,["value"])]})),_:1}),c(t,{class:"form-item"},{default:o((()=>[c(m,{class:"label"},{default:o((()=>[r("职业")])),_:1}),c(p,{class:"input",type:"text",placeholder:"请填写职业",modelValue:w.value.profession,"onUpdate:modelValue":e[1]||(e[1]=a=>w.value.profession=a)},null,8,["modelValue"])])),_:1})])),_:1}),c(q,{class:"form-button",onClick:B},{default:o((()=>[r("保 存")])),_:1})])),_:1})]})),_:1})}}}),[["__scopeId","data-v-6f2dc2e6"]]);export{w as default};
